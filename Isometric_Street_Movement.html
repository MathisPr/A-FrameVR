<!doctype html>
<html>
    <head>
        <title>A-Frame Walk in a Street by Night</title>
        <!-- A-Frame Script-->
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <!-- Script for event-set -->
        <script src="https://unpkg.com/aframe-event-set-component@^4.0.0/dist/aframe-event-set-component.min.js"></script>
        <!-- Script A-Frame Extras -->
        <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
        <!-- Navigation Mesh A-Frame Inspector Plugin by Don McCurdy-->
        <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
        <!-- -->
        <script src="https://unpkg.com/aframe-animation-component@5.1.2/dist/aframe-animation-component.min.js"></script>
    </head>
    
    <a-assets>
        <a-asset-item
            id="Isometric_Street"
            src="https://raw.githubusercontent.com/MathisPr/ARProject/main/assets/Isometric_Street.gltf"
        ></a-asset-item>

        <a-asset
            id="Nav_Mesh"
            src="https://raw.githubusercontent.com/MathisPr/A-FrameVR/main/Isometric_Street_Nav-Mesh.gltf"
        ></a-asset>

        <!--
        <audio src="https://cdn.aframe.io/basic-guide/audio/backgroundnoise.wav" autoplay
        preload></audio>
        -->

        <!-- src="assets/Isometric_Street.gltf" -->
    </a-assets>


    <body>
        <a-scene inspector-plugin-recast>
            <!-- Camera Rig -->
            <a-entity position="0 0 6" movement-controls="constrainToNavMesh: true">
                <!-- Camera -->
                <!-- The "easing" property has been removed from the wasd-controls component (line 17) -->
                <!-- look-controls="pointerLockEnabled: true" - means Camera follows mouse -->
                <!-- wasd-controls - means speed of movement; ceep it slow in VR -->
                <!--
                <a-entity camera position="7 1.6 0"
					  look-controls="pointerLockEnabled: true"
					  wasd-controls="acceleration: 50">
                </a-entity>
                -->

                <!-- RIG -->
                
                <!--
                <a-camera 
                    position="7 1.6 0"
					look-controls="pointerLockEnabled: true"
                    wasd-controls="acceleration: 50"
                    movement-controls="constrainToNavMesh: true"  
                >
                -->

                  <!-- CAMERA -->
                <a-camera>
                    <a-entity id="rig" movement-controls="constrainToNavMesh: true">
                        <a-entity camera look-controls="pointerLockEnabled: true" position="0 1.6 0"></a-entity>
                    </a-entity>

                    <!-- Cursor -->  
                    <a-entity 
                      cursor="fuse: true; fuseTimeout: 1500" 
                      position="0 0 -1"
                      geometry="primitive: sphere; radius: 0.01"
                      material="color: #000000; shader: flat; opacity: 0.5"
                    >
                        <!-- Animation Cursor scale - not working -->
                        <a-animation    
                        animation__color="property: components.material.material.color; type: color; dir: alternate; dur: 1000;
                        easing: easeInSine; loop: true; to: #FFF">

                        <!--
                        attribute="scale"
                                to="15 15 15"
                                dur="1500"
                                begin="cursor-fusing"
                                fill="backwards"
                        -->

                        </a-animation>
                    </a-entity>

                    <a-entity 
                        text="value: Move with WASD; width: 5; color: #eee; align: middle; anchor: center; side: double; zOffset: 0.01" 
                        position="0 0 -6"
                    ></a-entity>


                </a-camera>

            </a-entity>

            <!-- Sky -->
            <a-sky color="#212121"></a-sky>


            <!-- Street Scene -->
            <a-entity
                id="Isometric_Street"
                scale="1 1 1"
                gltf-model="#Isometric_Street"
    
                shader="standard"
                shadow="true"
                >
            </a-entity>


            <!-- Nav-Mesh Scene -->
            <a-entity
                position="0 0 0.2"    
                gltf-model="#Nav_Mesh"
                nav-mesh
                visible="true"
            >
            </a-entity>

            <!-- sound -->
            <a-sound 
                src="https://cdn.aframe.io/basic-guide/audio/backgroundnoise.wav" 
                autoplay="true"
                position="10.8 3.4 0.25"
                loop="true"
            ></a-sound>


        <!-- Light System-->

            <!-- Street-Light 1 -->
            <a-entity
                position="10.8 3.4 0.25"
                light="type: point; color: #e2c712;  intensity: 4;  castShadow: true; distance: 3"
            ></a-entity>

            <a-entity   light="type: spot; angle: -20; color: #e2c712; castShadow: true; penumbra: 1; target: null; distance: 5; intensity: 15"
                        position="10.8 3.4 0.25"
                        rotation="-90 0 0"
            >
            </a-entity>

            <!-- Street-Light 2 -->
            <a-entity
                position="10.8 3.4 -7"
                light="type:  point;  color: #e2c712;  intensity:  4;  castShadow:  true; distance: 3"
            ></a-entity>

            <a-entity   light="type: spot; angle: -20; color: #e2c712; castShadow: true; penumbra: 1; target: null; distance: 5; intensity: 15"
                        position="10.8 3.4 -7"
                        rotation="-90 0 0"
            >
            </a-entity>

            <!-- Street-Light 3 -->
            <a-entity
                position="10.8 3.4 -14"
                light="type:  point;  color: #e2c712;  intensity:  4;  castShadow:  true; distance: 3"
            ></a-entity>

            <a-entity   light="type: spot; angle: -20; color: #e2c712; castShadow: true; penumbra: 1; target: null; distance: 5; intensity: 15"
                        position="10.8 3.4 -14"
                        rotation="-90 0 0"
            >
            </a-entity>

            <!-- Ambient Light -->
            <a-entity light="color: #a8a4a4; intensity: 0.2; type: ambient"></a-entity>

            <!-- Light Door Appartment-->
            <a-entity
                position="3 2 -6.5"
                light="type:  point;  color:  #00fffb;  intensity:  15;  castShadow:  true; distance: 5"
            ></a-entity>

            <!-- Light Store Sign-->
            <a-entity 
                light="type: point; color: #2abbb9; intensity:  1; castShadow: true; distance: 5"
                position="3.2 4.5 0.5">
            </a-entity>

            <!-- Light Appartment Sign-->
            <a-entity 
                light="type: point; color: #2abbb9; intensity:  1; castShadow: true; distance: 5" 
                position="-2 6.5 -5.5">
            </a-entity>
            
            <!-- Light vending machine -->
            <a-entity 
                light="type: point; color: #2abbb9; intensity:  3; castShadow: true; distance: 5" 
                position="3 1 3.5">
            </a-entity>

            <!-- Light Newspaperstand -->
            <a-entity 
                light="type: point; color: #2abbb9; intensity:  2; castShadow: true; distance: 5" 
                position="4 0.5 -2.5">
            </a-entity>

            <!-- ground -->
            <!--
            <a-plane scale="8 4 1" position="" color="grey" rotation="-90 0 0"></a-plane>
            -->

            
        <!-- Interaction -->
            <a-box  
                    id="box"
                    color="blue" 
                    position="9 1.5 -9"
                    event-set__enter="_event: mouseenter; _target: #TestText; visible: true"     
                    event-set__leave="_event: mouseleave; _target: #TestText; visible: false"
                    event-set__tarcol="_event: click; _target: #box; material.color: #ff2300"
            >

            <a-text
                id="TestText"
                position="0 1 0"
                color="white"
                value="Das ist ein Test"
                visible="false"
            ></a-text>

            </a-box>

        </a-scene>
    </body>
</html>


